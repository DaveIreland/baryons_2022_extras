
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Baryons 2022 - notes &#8212; Baryons_2022_Extras</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Welcome to your Jupyter Book" href="intro.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/nstar_resonances_year.svg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Baryons_2022_Extras</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Baryons 2022 - notes
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/DaveIreland/Baryons_2022_Extras/main?urlpath=tree/docs/Baryons_2022_notes.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/DaveIreland/Baryons_2022_Extras"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/DaveIreland/Baryons_2022_Extras/issues/new?title=Issue%20on%20page%20%2FBaryons_2022_notes.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/Baryons_2022_notes.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#baryon-spectrum">
   Baryon Spectrum
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#kinematic-fit-demo">
   Kinematic Fit Demo
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#post-baryons-conference-additions">
   Post Baryons Conference Additions
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Baryons 2022 - notes</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#baryon-spectrum">
   Baryon Spectrum
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#kinematic-fit-demo">
   Kinematic Fit Demo
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#post-baryons-conference-additions">
   Post Baryons Conference Additions
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="baryons-2022-notes">
<h1>Baryons 2022 - notes<a class="headerlink" href="#baryons-2022-notes" title="Permalink to this headline">#</a></h1>
<p>Notebook for creating plots and pictures to accompany the talk for the conference.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Common imports
import numpy as np
%matplotlib inline

import matplotlib.pyplot as plt
import seaborn as sns
import pandas as pd
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from matplotlib.collections import PatchCollection
from matplotlib.patches import Rectangle
from matplotlib.ticker import FuncFormatter, MaxNLocator

# For plotting styles...
sns.set_style(&quot;ticks&quot;)
sns.set_context(&quot;talk&quot;)
#sns.axes_style()


label_size = 20
plt.rcParams[&#39;axes.labelsize&#39;] = label_size 
#plt.rcParams[&#39;ylabel.size&#39;] = label_size 
#print(plt.rcParams.keys())

legend_size = 20

ticklabel_size = 20
plt.rcParams[&#39;xtick.labelsize&#39;] = ticklabel_size 
plt.rcParams[&#39;ytick.labelsize&#39;] = ticklabel_size 

# for PPNP consistency...
plt.rcParams[&#39;font.family&#39;] = &#39;DejaVu Serif&#39;
</pre></div>
</div>
</div>
</div>
<section id="baryon-spectrum">
<h2>Baryon Spectrum<a class="headerlink" href="#baryon-spectrum" title="Permalink to this headline">#</a></h2>
<p>Use the plot code from the PPNP article</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Read in PDG data...
nstar_1996_df = pd.read_csv(&#39;PDG1996_Nstar.csv&#39;,header=None,names=[&#39;resonance&#39;,&#39;jp&#39;,&#39;rating&#39;,&#39;mass&#39;,&#39;width&#39;])
nstar_2022_df = pd.read_csv(&#39;PDG2022_Nstar.csv&#39;,header=None,names=[&#39;resonance&#39;,&#39;jp&#39;,&#39;rating&#39;,&#39;mass&#39;,&#39;width&#39;])
delta_1996_df = pd.read_csv(&#39;PDG1996_Delta.csv&#39;,header=None,names=[&#39;resonance&#39;,&#39;jp&#39;,&#39;rating&#39;,&#39;mass&#39;,&#39;width&#39;])
delta_2022_df = pd.read_csv(&#39;PDG2022_Delta.csv&#39;,header=None,names=[&#39;resonance&#39;,&#39;jp&#39;,&#39;rating&#39;,&#39;mass&#39;,&#39;width&#39;])

# Collect DFs in array...
df_array = [nstar_1996_df, nstar_2022_df, delta_1996_df, delta_2022_df]

# Convert spin-parity to x-axis position...
def jp_to_x(str):
    j,p = str.split(&#39;/&#39;)
    if p[-1] == u&#39;-&#39; or p[-1] == chr(8722):
        pad = 18.0
    else:
        pad = 0.0
    return float(j)+pad

# Apply to all DFs...
for df in df_array:
    df[&#39;x_pos&#39;] = df[&#39;jp&#39;].apply(jp_to_x)
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>rating_arr = [&#39;*&#39;,&#39;**&#39;,&#39;***&#39;,&#39;****&#39;]

nstar_count_1996 = []
nstar_count_2022 = []
for r in rating_arr:
    nstar_count_1996.append(sum(nstar_1996_df[&#39;rating&#39;]==r))
    nstar_count_2022.append(sum(nstar_2022_df[&#39;rating&#39;]==r))
    
nstar_rating_df = pd.DataFrame(zip(nstar_count_1996,nstar_count_2022),columns=[&#39;1996&#39;,&#39;2022&#39;],index=rating_arr)
nstar_rating_df.plot.bar(color={&quot;1996&quot;: &quot;xkcd:amber&quot;, &quot;2022&quot;: &quot;xkcd:windows blue&quot;})
plt.grid(True)
plt.ylim(0,16)
plt.title(r&#39;PDG N$^{\ast}$ Resonances by Year&#39;)
plt.savefig(&#39;figures/nstar_resonances_year.svg&#39;, bbox_inches=&#39;tight&#39;)
plt.show()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Baryons_2022_notes_5_0.png" src="_images/Baryons_2022_notes_5_0.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>delta_count_1996 = []
delta_count_2022 = []
for r in rating_arr:
    delta_count_1996.append(sum(delta_1996_df[&#39;rating&#39;]==r))
    delta_count_2022.append(sum(delta_2022_df[&#39;rating&#39;]==r))
    
delta_rating_df = pd.DataFrame(zip(delta_count_1996,delta_count_2022),columns=[&#39;1996&#39;,&#39;2022&#39;],index=rating_arr)
delta_rating_df.plot.bar(color={&quot;1996&quot;: &quot;xkcd:amber&quot;, &quot;2022&quot;: &quot;xkcd:windows blue&quot;})
plt.grid(True)
plt.title(r&#39;PDG $\Delta$ Resonances by Year&#39;)
plt.savefig(&#39;figures/delta_resonances_year.svg&#39;, bbox_inches=&#39;tight&#39;)
plt.show()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Baryons_2022_notes_6_0.png" src="_images/Baryons_2022_notes_6_0.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Taken from somewhere else; can&#39;t recall!
# Create boxes in teh correct places for plotting on spectrum
def make_rerror_boxes(ax, df, xoff=0.0, facecolor=&#39;xkcd:windows blue&#39;, 
                     edgecolor=&#39;None&#39;, alpha=0.3):

    # Get calues from DataFrame...
    xdata  = np.array(df[&#39;x_pos&#39;].values)
    ydata  = np.array(df[&#39;mass&#39;].values) 
    xerror = 0.4*np.ones((2,len(xdata)))     
    widths = np.array(df[&#39;width&#39;].values)
    yerror = 0.5*np.array([widths,widths])
    stars  = df[&#39;rating&#39;].values

    
    # set array of alpha values...
    alphas = []
    for s in stars:
        if s==&#39;*&#39;:
            alphas.append(0.1)
        elif s==&#39;**&#39;:
            alphas.append(0.4)
        elif s==&#39;***&#39;:
            alphas.append(0.7)
        else:
            alphas.append(1.0)
            
    # Create list for all the error patches
    errorboxes = []

    # Loop over data points; create box from errors at each point
    for x, y, xe, ye, a in zip(xdata, ydata, xerror.T, yerror.T, alphas):
        rect = Rectangle((xoff + x - xe[0], y - ye[0]), xe.sum(), ye.sum(), fc=facecolor, alpha=a)
        ax.add_patch(rect)

    # Plot errorbars
    artists = ax.errorbar(np.array(xdata)+xoff, ydata, xerr=xerror, fmt=&#39;None&#39;, ecolor=&#39;k&#39;)

    return artists
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Create figure and axes
plt.rc(&#39;text&#39;, usetex=True)
plt.rc(&#39;font&#39;, family=&#39;serif&#39;)


def make_spectrum_plot(df1,df2,title,savefile=None):
    fig, ax = plt.subplots(1,figsize=(12,8))
    plt.rc(&#39;text&#39;, usetex=True)
    plt.rc(&#39;font&#39;, family=&#39;serif&#39;)

    # Call function to create error boxes
    _ = make_rerror_boxes(ax, df1, -0.4, r&#39;xkcd:amber&#39;)
    _ = make_rerror_boxes(ax, df2, 0.4)


    labels = [ r&#39;$\frac{1}{2}^{+}$&#39;,
               r&#39;$\frac{3}{2}^{+}$&#39;,
               r&#39;$\frac{5}{2}^{+}$&#39;,
               r&#39;$\frac{7}{2}^{+}$&#39;,
               r&#39;$\frac{9}{2}^{+}$&#39;,
               r&#39;$\frac{11}{2}^{+}$&#39;,
               r&#39;$\frac{13}{2}^{+}$&#39;,
               r&#39;$\frac{15}{2}^{+}$&#39;,
              &#39;&#39;,
               r&#39;$\frac{1}{2}^{-}$&#39;,
               r&#39;$\frac{3}{2}^{-}$&#39;,
               r&#39;$\frac{5}{2}^{-}$&#39;,
               r&#39;$\frac{7}{2}^{-}$&#39;,
               r&#39;$\frac{9}{2}^{-}$&#39;,
               r&#39;$\frac{11}{2}^{-}$&#39;,
               r&#39;$\frac{13}{2}^{-}$&#39;]

    locs = np.arange(1,33,2)


    ax.set_xlim((-0.5,32.5))
    ax.set_xlabel(&#39;Spin-Parity&#39;)
    ax.set_ylim((800,3100))
    ax.set_ylabel(r&#39;Mass (MeV/c$^2$)&#39;)

    plt.title(title,fontsize=30)
    plt.xticks(locs, labels)
    plt.plot([17,17], [800,3100], &#39;k--&#39;)

    # Create a Rectangle patch
    boxes = []
    boxes.append(Rectangle((11,1200),0.8,80,linewidth=1,edgecolor=&#39;none&#39;,facecolor=&#39;xkcd:amber&#39;,alpha=1.0))
    boxes.append(Rectangle((18,1200),0.8,80,linewidth=1,edgecolor=&#39;none&#39;,facecolor=&#39;xkcd:windows blue&#39;,alpha=1.0))
    boxes.append(Rectangle((11,1100),0.8,80,linewidth=1,edgecolor=&#39;none&#39;,facecolor=&#39;xkcd:amber&#39;,alpha=0.7))
    boxes.append(Rectangle((18,1100),0.8,80,linewidth=1,edgecolor=&#39;none&#39;,facecolor=&#39;xkcd:windows blue&#39;,alpha=0.7))
    boxes.append(Rectangle((11,1000),0.8,80,linewidth=1,edgecolor=&#39;none&#39;,facecolor=&#39;xkcd:amber&#39;,alpha=0.4))
    boxes.append(Rectangle((18,1000),0.8,80,linewidth=1,edgecolor=&#39;none&#39;,facecolor=&#39;xkcd:windows blue&#39;,alpha=0.4))
    boxes.append(Rectangle((11,900),0.8,80,linewidth=1,edgecolor=&#39;none&#39;,facecolor=&#39;xkcd:amber&#39;,alpha=0.1))
    boxes.append(Rectangle((18,900),0.8,80,linewidth=1,edgecolor=&#39;none&#39;,facecolor=&#39;xkcd:windows blue&#39;,alpha=0.1))

    # Add the patch to the Axes
    for b in boxes:
        ax.add_patch(b)
    

    plt.text(12, 1210, &#39;**** 1996&#39;, fontsize=16)
    plt.text(19, 1210, &#39;**** 2022&#39;, fontsize=16)
    plt.text(12, 1110, &#39;***&#39;, fontsize=16)
    plt.text(19, 1110, &#39;***&#39;, fontsize=16)
    plt.text(12, 1010, &#39;**&#39;, fontsize=16)
    plt.text(19, 1010, &#39;**&#39;, fontsize=16)
    plt.text(12, 910, &#39;*&#39;, fontsize=16)
    plt.text(19, 910, &#39;*&#39;, fontsize=16)

    if savefile:
        plt.savefig(savefile, bbox_inches=&#39;tight&#39;)
    plt.show()
    return


make_spectrum_plot(df1=nstar_1996_df,df2=nstar_2022_df,title=r&#39;N$^{\ast}$ Resonances&#39;,savefile=&#39;figures/nstar_spectrum_year.svg&#39;)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span>---------------------------------------------------------------------------
RuntimeError                              Traceback (most recent call last)
Cell In[7], line 76
     72     plt.show()
     73     return
---&gt; 76 make_spectrum_plot(df1=nstar_1996_df,df2=nstar_2022_df,title=r&#39;N$^{\ast}$ Resonances&#39;,savefile=&#39;figures/nstar_spectrum_year.svg&#39;)

Cell In[7], line 71, in make_spectrum_plot(df1, df2, title, savefile)
     68 plt.text(19, 910, &#39;*&#39;, fontsize=16)
     70 if savefile:
---&gt; 71     plt.savefig(savefile, bbox_inches=&#39;tight&#39;)
     72 plt.show()
     73 return

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/pyplot.py:954, in savefig(*args, **kwargs)
    951 @_copy_docstring_and_deprecators(Figure.savefig)
    952 def savefig(*args, **kwargs):
    953     fig = gcf()
--&gt; 954     res = fig.savefig(*args, **kwargs)
    955     fig.canvas.draw_idle()  # Need this if &#39;transparent=True&#39;, to reset colors.
    956     return res

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/figure.py:3274, in Figure.savefig(self, fname, transparent, **kwargs)
   3270     for ax in self.axes:
   3271         stack.enter_context(
   3272             ax.patch._cm_set(facecolor=&#39;none&#39;, edgecolor=&#39;none&#39;))
-&gt; 3274 self.canvas.print_figure(fname, **kwargs)

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/backend_bases.py:2314, in FigureCanvasBase.print_figure(self, filename, dpi, facecolor, edgecolor, orientation, format, bbox_inches, pad_inches, bbox_extra_artists, backend, **kwargs)
   2308     renderer = _get_renderer(
   2309         self.figure,
   2310         functools.partial(
   2311             print_method, orientation=orientation)
   2312     )
   2313     with getattr(renderer, &quot;_draw_disabled&quot;, nullcontext)():
-&gt; 2314         self.figure.draw(renderer)
   2316 if bbox_inches:
   2317     if bbox_inches == &quot;tight&quot;:

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/artist.py:74, in _finalize_rasterization.&lt;locals&gt;.draw_wrapper(artist, renderer, *args, **kwargs)
     72 @wraps(draw)
     73 def draw_wrapper(artist, renderer, *args, **kwargs):
---&gt; 74     result = draw(artist, renderer, *args, **kwargs)
     75     if renderer._rasterizing:
     76         renderer.stop_rasterizing()

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/artist.py:51, in allow_rasterization.&lt;locals&gt;.draw_wrapper(artist, renderer)
     48     if artist.get_agg_filter() is not None:
     49         renderer.start_filter()
---&gt; 51     return draw(artist, renderer)
     52 finally:
     53     if artist.get_agg_filter() is not None:

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/figure.py:3071, in Figure.draw(self, renderer)
   3068         # ValueError can occur when resizing a window.
   3070 self.patch.draw(renderer)
-&gt; 3071 mimage._draw_list_compositing_images(
   3072     renderer, self, artists, self.suppressComposite)
   3074 for sfig in self.subfigs:
   3075     sfig.draw(renderer)

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/image.py:131, in _draw_list_compositing_images(renderer, parent, artists, suppress_composite)
    129 if not_composite or not has_images:
    130     for a in artists:
--&gt; 131         a.draw(renderer)
    132 else:
    133     # Composite any adjacent images together
    134     image_group = []

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/artist.py:51, in allow_rasterization.&lt;locals&gt;.draw_wrapper(artist, renderer)
     48     if artist.get_agg_filter() is not None:
     49         renderer.start_filter()
---&gt; 51     return draw(artist, renderer)
     52 finally:
     53     if artist.get_agg_filter() is not None:

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/axes/_base.py:3071, in _AxesBase.draw(self, renderer)
   3068     for spine in self.spines.values():
   3069         artists.remove(spine)
-&gt; 3071 self._update_title_position(renderer)
   3073 if not self.axison:
   3074     for _axis in self._axis_map.values():

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/axes/_base.py:3015, in _AxesBase._update_title_position(self, renderer)
   3013 top = max(top, bb.ymax)
   3014 if title.get_text():
-&gt; 3015     ax.yaxis.get_tightbbox(renderer)  # update offsetText
   3016     if ax.yaxis.offsetText.get_text():
   3017         bb = ax.yaxis.offsetText.get_tightbbox(renderer)

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/axis.py:1253, in Axis.get_tightbbox(self, renderer, for_layout_only)
   1250     renderer = self.figure._get_renderer()
   1251 ticks_to_draw = self._update_ticks()
-&gt; 1253 self._update_label_position(renderer)
   1255 # go back to just this axis&#39;s tick labels
   1256 tlb1, tlb2 = self._get_ticklabel_bboxes(ticks_to_draw, renderer)

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/axis.py:2506, in YAxis._update_label_position(self, renderer)
   2502     return
   2504 # get bounding boxes for this axis and any siblings
   2505 # that have been set by `fig.align_ylabels()`
-&gt; 2506 bboxes, bboxes2 = self._get_tick_boxes_siblings(renderer=renderer)
   2507 x, y = self.label.get_position()
   2508 if self.label_position == &#39;left&#39;:

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/axis.py:2056, in Axis._get_tick_boxes_siblings(self, renderer)
   2054 axis = getattr(ax, f&quot;{axis_name}axis&quot;)
   2055 ticks_to_draw = axis._update_ticks()
-&gt; 2056 tlb, tlb2 = axis._get_ticklabel_bboxes(ticks_to_draw, renderer)
   2057 bboxes.extend(tlb)
   2058 bboxes2.extend(tlb2)

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/axis.py:1232, in Axis._get_ticklabel_bboxes(self, ticks, renderer)
   1230 if renderer is None:
   1231     renderer = self.figure._get_renderer()
-&gt; 1232 return ([tick.label1.get_window_extent(renderer)
   1233          for tick in ticks if tick.label1.get_visible()],
   1234         [tick.label2.get_window_extent(renderer)
   1235          for tick in ticks if tick.label2.get_visible()])

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/axis.py:1232, in &lt;listcomp&gt;(.0)
   1230 if renderer is None:
   1231     renderer = self.figure._get_renderer()
-&gt; 1232 return ([tick.label1.get_window_extent(renderer)
   1233          for tick in ticks if tick.label1.get_visible()],
   1234         [tick.label2.get_window_extent(renderer)
   1235          for tick in ticks if tick.label2.get_visible()])

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/text.py:915, in Text.get_window_extent(self, renderer, dpi)
    910     raise RuntimeError(
    911         &quot;Cannot get window extent of text w/o renderer. You likely &quot;
    912         &quot;want to call &#39;figure.draw_without_rendering()&#39; first.&quot;)
    914 with cbook._setattr_cm(self.figure, dpi=dpi):
--&gt; 915     bbox, info, descent = self._get_layout(self._renderer)
    916     x, y = self.get_unitless_position()
    917     x, y = self.get_transform().transform((x, y))

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/text.py:313, in Text._get_layout(self, renderer)
    310 ys = []
    312 # Full vertical extent of font, including ascenders and descenders:
--&gt; 313 _, lp_h, lp_d = _get_text_metrics_with_cache(
    314     renderer, &quot;lp&quot;, self._fontproperties,
    315     ismath=&quot;TeX&quot; if self.get_usetex() else False, dpi=self.figure.dpi)
    316 min_dy = (lp_h - lp_d) * self._linespacing
    318 for i, line in enumerate(lines):

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/text.py:97, in _get_text_metrics_with_cache(renderer, text, fontprop, ismath, dpi)
     94 &quot;&quot;&quot;Call ``renderer.get_text_width_height_descent``, caching the results.&quot;&quot;&quot;
     95 # Cached based on a copy of fontprop so that later in-place mutations of
     96 # the passed-in argument do not mess up the cache.
---&gt; 97 return _get_text_metrics_with_cache_impl(
     98     weakref.ref(renderer), text, fontprop.copy(), ismath, dpi)

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/text.py:105, in _get_text_metrics_with_cache_impl(renderer_ref, text, fontprop, ismath, dpi)
    101 @functools.lru_cache(4096)
    102 def _get_text_metrics_with_cache_impl(
    103         renderer_ref, text, fontprop, ismath, dpi):
    104     # dpi is unused, but participates in cache invalidation (via the renderer).
--&gt; 105     return renderer_ref().get_text_width_height_descent(text, fontprop, ismath)

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/backends/backend_svg.py:1346, in RendererSVG.get_text_width_height_descent(self, s, prop, ismath)
   1344 def get_text_width_height_descent(self, s, prop, ismath):
   1345     # docstring inherited
-&gt; 1346     return self._text2path.get_text_width_height_descent(s, prop, ismath)

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/textpath.py:52, in TextToPath.get_text_width_height_descent(self, s, prop, ismath)
     49 fontsize = prop.get_size_in_points()
     51 if ismath == &quot;TeX&quot;:
---&gt; 52     return TexManager().get_text_width_height_descent(s, fontsize)
     54 scale = fontsize / self.FONT_SCALE
     56 if ismath:

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/texmanager.py:362, in TexManager.get_text_width_height_descent(cls, tex, fontsize, renderer)
    360 if tex.strip() == &#39;&#39;:
    361     return 0, 0, 0
--&gt; 362 dvifile = cls.make_dvi(tex, fontsize)
    363 dpi_fraction = renderer.points_to_pixels(1.) if renderer else 1
    364 with dviread.Dvi(dvifile, 72 * dpi_fraction) as dvi:

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/texmanager.py:295, in TexManager.make_dvi(cls, tex, fontsize)
    286     # Generate the dvi in a temporary directory to avoid race
    287     # conditions e.g. if multiple processes try to process the same tex
    288     # string at the same time.  Having tmpdir be a subdirectory of the
   (...)
    292     # the absolute path may contain characters (e.g. ~) that TeX does
    293     # not support.)
    294     with TemporaryDirectory(dir=Path(dvifile).parent) as tmpdir:
--&gt; 295         cls._run_checked_subprocess(
    296             [&quot;latex&quot;, &quot;-interaction=nonstopmode&quot;, &quot;--halt-on-error&quot;,
    297              f&quot;../{texfile.name}&quot;], tex, cwd=tmpdir)
    298         (Path(tmpdir) / Path(dvifile).name).replace(dvifile)
    299 return dvifile

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/texmanager.py:261, in TexManager._run_checked_subprocess(cls, command, tex, cwd)
    257     raise RuntimeError(
    258         &#39;Failed to process string with tex because {} could not be &#39;
    259         &#39;found&#39;.format(command[0])) from exc
    260 except subprocess.CalledProcessError as exc:
--&gt; 261     raise RuntimeError(
    262         &#39;{prog} was not able to process the following string:\n&#39;
    263         &#39;{tex!r}\n\n&#39;
    264         &#39;Here is the full command invocation and its output:\n\n&#39;
    265         &#39;{format_command}\n\n&#39;
    266         &#39;{exc}\n\n&#39;.format(
    267             prog=command[0],
    268             format_command=cbook._pformat_subprocess(command),
    269             tex=tex.encode(&#39;unicode_escape&#39;),
    270             exc=exc.output.decode(&#39;utf-8&#39;, &#39;backslashreplace&#39;))
    271         ) from None
    272 _log.debug(report)
    273 return report

RuntimeError: latex was not able to process the following string:
b&#39;lp&#39;

Here is the full command invocation and its output:

latex -interaction=nonstopmode --halt-on-error ../b1f6e526c8f59347b3e60c011cbf0b53.tex

This is pdfTeX, Version 3.141592653-2.6-1.40.24 (TeX Live 2022) (preloaded format=latex)
 restricted \write18 enabled.
entering extended mode
(../b1f6e526c8f59347b3e60c011cbf0b53.tex
LaTeX2e &lt;2022-11-01&gt; patch level 1
L3 programming layer &lt;2022-11-02&gt; (/home/runner/.TinyTeX/texmf-dist/tex/latex/base/article.cls
Document Class: article 2022/07/02 v1.4n Standard LaTeX document class
(/home/runner/.TinyTeX/texmf-dist/tex/latex/base/size10.clo))

! LaTeX Error: File `type1cm.sty&#39; not found.

Type X to quit or &lt;RETURN&gt; to proceed,
or enter new name. (Default extension: sty)

Enter file name: 
! Emergency stop.
&lt;read *&gt; 
         
l.8 \usepackage
               {type1ec}^^M
No pages of output.
Transcript written on b1f6e526c8f59347b3e60c011cbf0b53.log.


</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Error in callback &lt;function _draw_all_if_interactive at 0x7f323c0a2550&gt; (for post_execute):
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span>---------------------------------------------------------------------------
RuntimeError                              Traceback (most recent call last)
File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/pyplot.py:119, in _draw_all_if_interactive()
    117 def _draw_all_if_interactive():
    118     if matplotlib.is_interactive():
--&gt; 119         draw_all()

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/_pylab_helpers.py:132, in Gcf.draw_all(cls, force)
    130 for manager in cls.get_all_fig_managers():
    131     if force or manager.canvas.figure.stale:
--&gt; 132         manager.canvas.draw_idle()

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/backend_bases.py:2054, in FigureCanvasBase.draw_idle(self, *args, **kwargs)
   2052 if not self._is_idle_drawing:
   2053     with self._idle_draw_cntx():
-&gt; 2054         self.draw(*args, **kwargs)

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/backends/backend_agg.py:405, in FigureCanvasAgg.draw(self)
    401 # Acquire a lock on the shared font cache.
    402 with RendererAgg.lock, \
    403      (self.toolbar._wait_cursor_for_draw_cm() if self.toolbar
    404       else nullcontext()):
--&gt; 405     self.figure.draw(self.renderer)
    406     # A GUI class may be need to update a window using this draw, so
    407     # don&#39;t forget to call the superclass.
    408     super().draw()

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/artist.py:74, in _finalize_rasterization.&lt;locals&gt;.draw_wrapper(artist, renderer, *args, **kwargs)
     72 @wraps(draw)
     73 def draw_wrapper(artist, renderer, *args, **kwargs):
---&gt; 74     result = draw(artist, renderer, *args, **kwargs)
     75     if renderer._rasterizing:
     76         renderer.stop_rasterizing()

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/artist.py:51, in allow_rasterization.&lt;locals&gt;.draw_wrapper(artist, renderer)
     48     if artist.get_agg_filter() is not None:
     49         renderer.start_filter()
---&gt; 51     return draw(artist, renderer)
     52 finally:
     53     if artist.get_agg_filter() is not None:

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/figure.py:3071, in Figure.draw(self, renderer)
   3068         # ValueError can occur when resizing a window.
   3070 self.patch.draw(renderer)
-&gt; 3071 mimage._draw_list_compositing_images(
   3072     renderer, self, artists, self.suppressComposite)
   3074 for sfig in self.subfigs:
   3075     sfig.draw(renderer)

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/image.py:131, in _draw_list_compositing_images(renderer, parent, artists, suppress_composite)
    129 if not_composite or not has_images:
    130     for a in artists:
--&gt; 131         a.draw(renderer)
    132 else:
    133     # Composite any adjacent images together
    134     image_group = []

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/artist.py:51, in allow_rasterization.&lt;locals&gt;.draw_wrapper(artist, renderer)
     48     if artist.get_agg_filter() is not None:
     49         renderer.start_filter()
---&gt; 51     return draw(artist, renderer)
     52 finally:
     53     if artist.get_agg_filter() is not None:

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/axes/_base.py:3071, in _AxesBase.draw(self, renderer)
   3068     for spine in self.spines.values():
   3069         artists.remove(spine)
-&gt; 3071 self._update_title_position(renderer)
   3073 if not self.axison:
   3074     for _axis in self._axis_map.values():

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/axes/_base.py:3015, in _AxesBase._update_title_position(self, renderer)
   3013 top = max(top, bb.ymax)
   3014 if title.get_text():
-&gt; 3015     ax.yaxis.get_tightbbox(renderer)  # update offsetText
   3016     if ax.yaxis.offsetText.get_text():
   3017         bb = ax.yaxis.offsetText.get_tightbbox(renderer)

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/axis.py:1253, in Axis.get_tightbbox(self, renderer, for_layout_only)
   1250     renderer = self.figure._get_renderer()
   1251 ticks_to_draw = self._update_ticks()
-&gt; 1253 self._update_label_position(renderer)
   1255 # go back to just this axis&#39;s tick labels
   1256 tlb1, tlb2 = self._get_ticklabel_bboxes(ticks_to_draw, renderer)

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/axis.py:2506, in YAxis._update_label_position(self, renderer)
   2502     return
   2504 # get bounding boxes for this axis and any siblings
   2505 # that have been set by `fig.align_ylabels()`
-&gt; 2506 bboxes, bboxes2 = self._get_tick_boxes_siblings(renderer=renderer)
   2507 x, y = self.label.get_position()
   2508 if self.label_position == &#39;left&#39;:

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/axis.py:2056, in Axis._get_tick_boxes_siblings(self, renderer)
   2054 axis = getattr(ax, f&quot;{axis_name}axis&quot;)
   2055 ticks_to_draw = axis._update_ticks()
-&gt; 2056 tlb, tlb2 = axis._get_ticklabel_bboxes(ticks_to_draw, renderer)
   2057 bboxes.extend(tlb)
   2058 bboxes2.extend(tlb2)

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/axis.py:1232, in Axis._get_ticklabel_bboxes(self, ticks, renderer)
   1230 if renderer is None:
   1231     renderer = self.figure._get_renderer()
-&gt; 1232 return ([tick.label1.get_window_extent(renderer)
   1233          for tick in ticks if tick.label1.get_visible()],
   1234         [tick.label2.get_window_extent(renderer)
   1235          for tick in ticks if tick.label2.get_visible()])

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/axis.py:1232, in &lt;listcomp&gt;(.0)
   1230 if renderer is None:
   1231     renderer = self.figure._get_renderer()
-&gt; 1232 return ([tick.label1.get_window_extent(renderer)
   1233          for tick in ticks if tick.label1.get_visible()],
   1234         [tick.label2.get_window_extent(renderer)
   1235          for tick in ticks if tick.label2.get_visible()])

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/text.py:915, in Text.get_window_extent(self, renderer, dpi)
    910     raise RuntimeError(
    911         &quot;Cannot get window extent of text w/o renderer. You likely &quot;
    912         &quot;want to call &#39;figure.draw_without_rendering()&#39; first.&quot;)
    914 with cbook._setattr_cm(self.figure, dpi=dpi):
--&gt; 915     bbox, info, descent = self._get_layout(self._renderer)
    916     x, y = self.get_unitless_position()
    917     x, y = self.get_transform().transform((x, y))

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/text.py:313, in Text._get_layout(self, renderer)
    310 ys = []
    312 # Full vertical extent of font, including ascenders and descenders:
--&gt; 313 _, lp_h, lp_d = _get_text_metrics_with_cache(
    314     renderer, &quot;lp&quot;, self._fontproperties,
    315     ismath=&quot;TeX&quot; if self.get_usetex() else False, dpi=self.figure.dpi)
    316 min_dy = (lp_h - lp_d) * self._linespacing
    318 for i, line in enumerate(lines):

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/text.py:97, in _get_text_metrics_with_cache(renderer, text, fontprop, ismath, dpi)
     94 &quot;&quot;&quot;Call ``renderer.get_text_width_height_descent``, caching the results.&quot;&quot;&quot;
     95 # Cached based on a copy of fontprop so that later in-place mutations of
     96 # the passed-in argument do not mess up the cache.
---&gt; 97 return _get_text_metrics_with_cache_impl(
     98     weakref.ref(renderer), text, fontprop.copy(), ismath, dpi)

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/text.py:105, in _get_text_metrics_with_cache_impl(renderer_ref, text, fontprop, ismath, dpi)
    101 @functools.lru_cache(4096)
    102 def _get_text_metrics_with_cache_impl(
    103         renderer_ref, text, fontprop, ismath, dpi):
    104     # dpi is unused, but participates in cache invalidation (via the renderer).
--&gt; 105     return renderer_ref().get_text_width_height_descent(text, fontprop, ismath)

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/backends/backend_agg.py:229, in RendererAgg.get_text_width_height_descent(self, s, prop, ismath)
    227     texmanager = self.get_texmanager()
    228     fontsize = prop.get_size_in_points()
--&gt; 229     w, h, d = texmanager.get_text_width_height_descent(
    230         s, fontsize, renderer=self)
    231     return w, h, d
    233 if ismath:

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/texmanager.py:362, in TexManager.get_text_width_height_descent(cls, tex, fontsize, renderer)
    360 if tex.strip() == &#39;&#39;:
    361     return 0, 0, 0
--&gt; 362 dvifile = cls.make_dvi(tex, fontsize)
    363 dpi_fraction = renderer.points_to_pixels(1.) if renderer else 1
    364 with dviread.Dvi(dvifile, 72 * dpi_fraction) as dvi:

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/texmanager.py:295, in TexManager.make_dvi(cls, tex, fontsize)
    286     # Generate the dvi in a temporary directory to avoid race
    287     # conditions e.g. if multiple processes try to process the same tex
    288     # string at the same time.  Having tmpdir be a subdirectory of the
   (...)
    292     # the absolute path may contain characters (e.g. ~) that TeX does
    293     # not support.)
    294     with TemporaryDirectory(dir=Path(dvifile).parent) as tmpdir:
--&gt; 295         cls._run_checked_subprocess(
    296             [&quot;latex&quot;, &quot;-interaction=nonstopmode&quot;, &quot;--halt-on-error&quot;,
    297              f&quot;../{texfile.name}&quot;], tex, cwd=tmpdir)
    298         (Path(tmpdir) / Path(dvifile).name).replace(dvifile)
    299 return dvifile

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/texmanager.py:261, in TexManager._run_checked_subprocess(cls, command, tex, cwd)
    257     raise RuntimeError(
    258         &#39;Failed to process string with tex because {} could not be &#39;
    259         &#39;found&#39;.format(command[0])) from exc
    260 except subprocess.CalledProcessError as exc:
--&gt; 261     raise RuntimeError(
    262         &#39;{prog} was not able to process the following string:\n&#39;
    263         &#39;{tex!r}\n\n&#39;
    264         &#39;Here is the full command invocation and its output:\n\n&#39;
    265         &#39;{format_command}\n\n&#39;
    266         &#39;{exc}\n\n&#39;.format(
    267             prog=command[0],
    268             format_command=cbook._pformat_subprocess(command),
    269             tex=tex.encode(&#39;unicode_escape&#39;),
    270             exc=exc.output.decode(&#39;utf-8&#39;, &#39;backslashreplace&#39;))
    271         ) from None
    272 _log.debug(report)
    273 return report

RuntimeError: latex was not able to process the following string:
b&#39;lp&#39;

Here is the full command invocation and its output:

latex -interaction=nonstopmode --halt-on-error ../b1f6e526c8f59347b3e60c011cbf0b53.tex

This is pdfTeX, Version 3.141592653-2.6-1.40.24 (TeX Live 2022) (preloaded format=latex)
 restricted \write18 enabled.
entering extended mode
(../b1f6e526c8f59347b3e60c011cbf0b53.tex
LaTeX2e &lt;2022-11-01&gt; patch level 1
L3 programming layer &lt;2022-11-02&gt; (/home/runner/.TinyTeX/texmf-dist/tex/latex/base/article.cls
Document Class: article 2022/07/02 v1.4n Standard LaTeX document class
(/home/runner/.TinyTeX/texmf-dist/tex/latex/base/size10.clo))

! LaTeX Error: File `type1cm.sty&#39; not found.

Type X to quit or &lt;RETURN&gt; to proceed,
or enter new name. (Default extension: sty)

Enter file name: 
! Emergency stop.
&lt;read *&gt; 
         
l.8 \usepackage
               {type1ec}^^M
No pages of output.
Transcript written on b1f6e526c8f59347b3e60c011cbf0b53.log.


</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span>---------------------------------------------------------------------------
RuntimeError                              Traceback (most recent call last)
File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/IPython/core/formatters.py:338, in BaseFormatter.__call__(self, obj)
    336     pass
    337 else:
--&gt; 338     return printer(obj)
    339 # Finally look for special method names
    340 method = get_real_method(obj, self.print_method)

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/IPython/core/pylabtools.py:152, in print_figure(fig, fmt, bbox_inches, base64, **kwargs)
    149     from matplotlib.backend_bases import FigureCanvasBase
    150     FigureCanvasBase(fig)
--&gt; 152 fig.canvas.print_figure(bytes_io, **kw)
    153 data = bytes_io.getvalue()
    154 if fmt == &#39;svg&#39;:

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/backend_bases.py:2314, in FigureCanvasBase.print_figure(self, filename, dpi, facecolor, edgecolor, orientation, format, bbox_inches, pad_inches, bbox_extra_artists, backend, **kwargs)
   2308     renderer = _get_renderer(
   2309         self.figure,
   2310         functools.partial(
   2311             print_method, orientation=orientation)
   2312     )
   2313     with getattr(renderer, &quot;_draw_disabled&quot;, nullcontext)():
-&gt; 2314         self.figure.draw(renderer)
   2316 if bbox_inches:
   2317     if bbox_inches == &quot;tight&quot;:

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/artist.py:74, in _finalize_rasterization.&lt;locals&gt;.draw_wrapper(artist, renderer, *args, **kwargs)
     72 @wraps(draw)
     73 def draw_wrapper(artist, renderer, *args, **kwargs):
---&gt; 74     result = draw(artist, renderer, *args, **kwargs)
     75     if renderer._rasterizing:
     76         renderer.stop_rasterizing()

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/artist.py:51, in allow_rasterization.&lt;locals&gt;.draw_wrapper(artist, renderer)
     48     if artist.get_agg_filter() is not None:
     49         renderer.start_filter()
---&gt; 51     return draw(artist, renderer)
     52 finally:
     53     if artist.get_agg_filter() is not None:

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/figure.py:3071, in Figure.draw(self, renderer)
   3068         # ValueError can occur when resizing a window.
   3070 self.patch.draw(renderer)
-&gt; 3071 mimage._draw_list_compositing_images(
   3072     renderer, self, artists, self.suppressComposite)
   3074 for sfig in self.subfigs:
   3075     sfig.draw(renderer)

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/image.py:131, in _draw_list_compositing_images(renderer, parent, artists, suppress_composite)
    129 if not_composite or not has_images:
    130     for a in artists:
--&gt; 131         a.draw(renderer)
    132 else:
    133     # Composite any adjacent images together
    134     image_group = []

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/artist.py:51, in allow_rasterization.&lt;locals&gt;.draw_wrapper(artist, renderer)
     48     if artist.get_agg_filter() is not None:
     49         renderer.start_filter()
---&gt; 51     return draw(artist, renderer)
     52 finally:
     53     if artist.get_agg_filter() is not None:

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/axes/_base.py:3071, in _AxesBase.draw(self, renderer)
   3068     for spine in self.spines.values():
   3069         artists.remove(spine)
-&gt; 3071 self._update_title_position(renderer)
   3073 if not self.axison:
   3074     for _axis in self._axis_map.values():

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/axes/_base.py:3015, in _AxesBase._update_title_position(self, renderer)
   3013 top = max(top, bb.ymax)
   3014 if title.get_text():
-&gt; 3015     ax.yaxis.get_tightbbox(renderer)  # update offsetText
   3016     if ax.yaxis.offsetText.get_text():
   3017         bb = ax.yaxis.offsetText.get_tightbbox(renderer)

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/axis.py:1253, in Axis.get_tightbbox(self, renderer, for_layout_only)
   1250     renderer = self.figure._get_renderer()
   1251 ticks_to_draw = self._update_ticks()
-&gt; 1253 self._update_label_position(renderer)
   1255 # go back to just this axis&#39;s tick labels
   1256 tlb1, tlb2 = self._get_ticklabel_bboxes(ticks_to_draw, renderer)

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/axis.py:2506, in YAxis._update_label_position(self, renderer)
   2502     return
   2504 # get bounding boxes for this axis and any siblings
   2505 # that have been set by `fig.align_ylabels()`
-&gt; 2506 bboxes, bboxes2 = self._get_tick_boxes_siblings(renderer=renderer)
   2507 x, y = self.label.get_position()
   2508 if self.label_position == &#39;left&#39;:

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/axis.py:2056, in Axis._get_tick_boxes_siblings(self, renderer)
   2054 axis = getattr(ax, f&quot;{axis_name}axis&quot;)
   2055 ticks_to_draw = axis._update_ticks()
-&gt; 2056 tlb, tlb2 = axis._get_ticklabel_bboxes(ticks_to_draw, renderer)
   2057 bboxes.extend(tlb)
   2058 bboxes2.extend(tlb2)

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/axis.py:1232, in Axis._get_ticklabel_bboxes(self, ticks, renderer)
   1230 if renderer is None:
   1231     renderer = self.figure._get_renderer()
-&gt; 1232 return ([tick.label1.get_window_extent(renderer)
   1233          for tick in ticks if tick.label1.get_visible()],
   1234         [tick.label2.get_window_extent(renderer)
   1235          for tick in ticks if tick.label2.get_visible()])

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/axis.py:1232, in &lt;listcomp&gt;(.0)
   1230 if renderer is None:
   1231     renderer = self.figure._get_renderer()
-&gt; 1232 return ([tick.label1.get_window_extent(renderer)
   1233          for tick in ticks if tick.label1.get_visible()],
   1234         [tick.label2.get_window_extent(renderer)
   1235          for tick in ticks if tick.label2.get_visible()])

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/text.py:915, in Text.get_window_extent(self, renderer, dpi)
    910     raise RuntimeError(
    911         &quot;Cannot get window extent of text w/o renderer. You likely &quot;
    912         &quot;want to call &#39;figure.draw_without_rendering()&#39; first.&quot;)
    914 with cbook._setattr_cm(self.figure, dpi=dpi):
--&gt; 915     bbox, info, descent = self._get_layout(self._renderer)
    916     x, y = self.get_unitless_position()
    917     x, y = self.get_transform().transform((x, y))

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/text.py:313, in Text._get_layout(self, renderer)
    310 ys = []
    312 # Full vertical extent of font, including ascenders and descenders:
--&gt; 313 _, lp_h, lp_d = _get_text_metrics_with_cache(
    314     renderer, &quot;lp&quot;, self._fontproperties,
    315     ismath=&quot;TeX&quot; if self.get_usetex() else False, dpi=self.figure.dpi)
    316 min_dy = (lp_h - lp_d) * self._linespacing
    318 for i, line in enumerate(lines):

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/text.py:97, in _get_text_metrics_with_cache(renderer, text, fontprop, ismath, dpi)
     94 &quot;&quot;&quot;Call ``renderer.get_text_width_height_descent``, caching the results.&quot;&quot;&quot;
     95 # Cached based on a copy of fontprop so that later in-place mutations of
     96 # the passed-in argument do not mess up the cache.
---&gt; 97 return _get_text_metrics_with_cache_impl(
     98     weakref.ref(renderer), text, fontprop.copy(), ismath, dpi)

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/text.py:105, in _get_text_metrics_with_cache_impl(renderer_ref, text, fontprop, ismath, dpi)
    101 @functools.lru_cache(4096)
    102 def _get_text_metrics_with_cache_impl(
    103         renderer_ref, text, fontprop, ismath, dpi):
    104     # dpi is unused, but participates in cache invalidation (via the renderer).
--&gt; 105     return renderer_ref().get_text_width_height_descent(text, fontprop, ismath)

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/backends/backend_agg.py:229, in RendererAgg.get_text_width_height_descent(self, s, prop, ismath)
    227     texmanager = self.get_texmanager()
    228     fontsize = prop.get_size_in_points()
--&gt; 229     w, h, d = texmanager.get_text_width_height_descent(
    230         s, fontsize, renderer=self)
    231     return w, h, d
    233 if ismath:

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/texmanager.py:362, in TexManager.get_text_width_height_descent(cls, tex, fontsize, renderer)
    360 if tex.strip() == &#39;&#39;:
    361     return 0, 0, 0
--&gt; 362 dvifile = cls.make_dvi(tex, fontsize)
    363 dpi_fraction = renderer.points_to_pixels(1.) if renderer else 1
    364 with dviread.Dvi(dvifile, 72 * dpi_fraction) as dvi:

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/texmanager.py:295, in TexManager.make_dvi(cls, tex, fontsize)
    286     # Generate the dvi in a temporary directory to avoid race
    287     # conditions e.g. if multiple processes try to process the same tex
    288     # string at the same time.  Having tmpdir be a subdirectory of the
   (...)
    292     # the absolute path may contain characters (e.g. ~) that TeX does
    293     # not support.)
    294     with TemporaryDirectory(dir=Path(dvifile).parent) as tmpdir:
--&gt; 295         cls._run_checked_subprocess(
    296             [&quot;latex&quot;, &quot;-interaction=nonstopmode&quot;, &quot;--halt-on-error&quot;,
    297              f&quot;../{texfile.name}&quot;], tex, cwd=tmpdir)
    298         (Path(tmpdir) / Path(dvifile).name).replace(dvifile)
    299 return dvifile

File /opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/matplotlib/texmanager.py:261, in TexManager._run_checked_subprocess(cls, command, tex, cwd)
    257     raise RuntimeError(
    258         &#39;Failed to process string with tex because {} could not be &#39;
    259         &#39;found&#39;.format(command[0])) from exc
    260 except subprocess.CalledProcessError as exc:
--&gt; 261     raise RuntimeError(
    262         &#39;{prog} was not able to process the following string:\n&#39;
    263         &#39;{tex!r}\n\n&#39;
    264         &#39;Here is the full command invocation and its output:\n\n&#39;
    265         &#39;{format_command}\n\n&#39;
    266         &#39;{exc}\n\n&#39;.format(
    267             prog=command[0],
    268             format_command=cbook._pformat_subprocess(command),
    269             tex=tex.encode(&#39;unicode_escape&#39;),
    270             exc=exc.output.decode(&#39;utf-8&#39;, &#39;backslashreplace&#39;))
    271         ) from None
    272 _log.debug(report)
    273 return report

RuntimeError: latex was not able to process the following string:
b&#39;lp&#39;

Here is the full command invocation and its output:

latex -interaction=nonstopmode --halt-on-error ../b1f6e526c8f59347b3e60c011cbf0b53.tex

This is pdfTeX, Version 3.141592653-2.6-1.40.24 (TeX Live 2022) (preloaded format=latex)
 restricted \write18 enabled.
entering extended mode
(../b1f6e526c8f59347b3e60c011cbf0b53.tex
LaTeX2e &lt;2022-11-01&gt; patch level 1
L3 programming layer &lt;2022-11-02&gt; (/home/runner/.TinyTeX/texmf-dist/tex/latex/base/article.cls
Document Class: article 2022/07/02 v1.4n Standard LaTeX document class
(/home/runner/.TinyTeX/texmf-dist/tex/latex/base/size10.clo))

! LaTeX Error: File `type1cm.sty&#39; not found.

Type X to quit or &lt;RETURN&gt; to proceed,
or enter new name. (Default extension: sty)

Enter file name: 
! Emergency stop.
&lt;read *&gt; 
         
l.8 \usepackage
               {type1ec}^^M
No pages of output.
Transcript written on b1f6e526c8f59347b3e60c011cbf0b53.log.


</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 1200x800 with 1 Axes&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>make_spectrum_plot(df1=delta_1996_df,df2=delta_2022_df,title=r&#39;$\Delta^{\ast}$ Resonances&#39;,savefile=&#39;figures/delta_spectrum_year.svg&#39;)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Baryons_2022_notes_9_0.png" src="_images/Baryons_2022_notes_9_0.png" />
</div>
</div>
</section>
<section id="kinematic-fit-demo">
<h2>Kinematic Fit Demo<a class="headerlink" href="#kinematic-fit-demo" title="Permalink to this headline">#</a></h2>
<p>This is based on plots that were constructed for the 2017(!) NSTAR conference. The kinematics are adjusted to illustrate a clear pion case.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Set mean values for the measured quantities, calculate measured mass...
# Measured momentum...
p_m = 200.0 
sig_p_m = 5.0

# Measured energy...
e_m = 235.0
sig_e_m = 10.0

# Mass calculated from measurements...
m_m = np.sqrt(e_m**2 - p_m**2)
sig_m_m = np.sqrt(((e_m**2 * sig_e_m**2) + (p_m**2 * sig_p_m**2))/(m_m**2))

print(f&#39;Calculated mass: {m_m:.3f} MeV/c^2&#39;)
print(f&#39;Uncertainty:      {sig_m_m:.3f} MeV/c^2&#39;)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Calculated mass: 123.390 MeV/c^2
Uncertainty:      20.698 MeV/c^2
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from scipy.stats import norm

def prob_e(p,m,e_0,sig_e_0):
    e = np.sqrt(p**2 + m**2)
    return norm.pdf(e,e_0,sig_e_0)
    
def prob_p(p,m,e_0,sig_e_0):
    e = np.sqrt(p**2 + m**2)
    return norm.pdf(e,e_0,sig_e_0)
    
    
range_p = np.linspace(0, 300, 100)
range_m = np.linspace(0, 300, 100)
X,Y = np.meshgrid(range_p, range_m)
Z = prob_e(X, Y,e_m,sig_e_m).T
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>fig = plt.figure(figsize=(8,8))

im = plt.imshow(Z, cmap=plt.cm.Blues, vmin=0, vmax=abs(Z).max(), extent=[0, 500, 0, 500], origin=&#39;lower&#39;)
im.set_interpolation(&#39;bilinear&#39;)

plt.title(f&#39;Values of mass and momentum given $E_m$ = {e_m:.2f} MeV&#39;)
plt.xlabel(r&#39;Momentum [MeV/c]&#39;)
plt.ylabel(r&#39;Mass [MeV/c$^2$]&#39;)

plt.savefig(&#39;figures/kinfit_e_p.svg&#39;, bbox_inches=&#39;tight&#39;)
plt.show()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Baryons_2022_notes_13_0.png" src="_images/Baryons_2022_notes_13_0.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>Z2 = norm.pdf(X,p_m,sig_p_m)
Z3 = norm.pdf(Y,m_m,sig_m_m)

fig = plt.figure(figsize=(8,8))

im = plt.imshow(Z, cmap=plt.cm.Blues, vmin=0, vmax=abs(Z).max(), 
            extent=[0, 300, 0, 300], origin=&#39;lower&#39;)
im.set_interpolation(&#39;bilinear&#39;)
im2 = plt.imshow(Z2, cmap=plt.cm.Greens, vmin=0, vmax=abs(Z).max(), alpha=0.7,
             extent=[0, 300, 0, 300], origin=&#39;lower&#39;)
im2.set_interpolation(&#39;bilinear&#39;)
# im3 = plt.imshow(Z3, cmap=plt.cm.Reds, vmin=0, vmax=abs(Z).max(), alpha=0.5,
#              extent=[0, 300, 0, 300], origin=&#39;lower&#39;)
# im3.set_interpolation(&#39;bilinear&#39;)

plt.title(f&#39;Independent measurement of momentum $p_m$ = {p_m:.2f} MeV/c&#39;)
plt.xlabel(r&#39;Momentum [MeV/c]&#39;)
plt.ylabel(r&#39;Mass [MeV/c$^2$]&#39;)

plt.savefig(&#39;figures/kinfit_e_p_p.svg&#39;, bbox_inches=&#39;tight&#39;)
plt.show()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Baryons_2022_notes_14_0.png" src="_images/Baryons_2022_notes_14_0.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>m_upper = (m_m + sig_m_m)*np.ones(range_p.shape)
m_lower = (m_m - sig_m_m)*np.ones(range_p.shape)

m_pion_pdg = 139.57

fig, ax = plt.subplots(1,figsize=(8,8))

im = plt.imshow(Z, cmap=plt.cm.Blues, vmin=0, vmax=abs(Z).max(), 
            extent=[0, 300, 0, 300], origin=&#39;lower&#39;)
im.set_interpolation(&#39;bilinear&#39;)
im2 = plt.imshow(Z2, cmap=plt.cm.Greens, vmin=0, vmax=abs(Z).max(), alpha=0.5,
             extent=[0, 300, 0, 300], origin=&#39;lower&#39;)
im2.set_interpolation(&#39;bilinear&#39;)
# im3 = plt.imshow(Z3, cmap=plt.cm.Reds, vmin=0, vmax=abs(Z).max(), alpha=0.7,
#              extent=[0, 300, 0, 300], origin=&#39;lower&#39;)
# im3.set_interpolation(&#39;bilinear&#39;)
plt.fill_between(range_p, m_upper, m_lower, alpha=0.2, color=&#39;xkcd:amber&#39;)
ax.axhline(m_m,color=&#39;xkcd:amber&#39;)
ax.axhline(m_pion_pdg,color=&#39;k&#39;)
ax.annotate(f&#39;Inferred mass: {m_m:.2f} MeV/c$^2$&#39;, 
            xy=(100, m_m), 
            xytext=(10, 70), 
            #fontsize=&#39;large&#39;,
            color=&#39;k&#39;,
            arrowprops=dict(facecolor=&#39;k&#39;,width=2,headwidth=8))
ax.annotate(f&#39;PDG $\pi^+$ mass: {m_pion_pdg: .2f} Mev/c$^2$&#39;, 
            xy=(170, m_pion_pdg), 
            xytext=(10, 170), 
            #fontsize=&#39;large&#39;,
            color=&#39;k&#39;,
            arrowprops=dict(facecolor=&#39;k&#39;,width=2,headwidth=8))

plt.xlabel(r&#39;Momentum [MeV/c]&#39;)
plt.ylabel(r&#39;Mass [MeV/c$^2$]&#39;)

plt.savefig(&#39;figures/kinfit_e_p_m.svg&#39;, bbox_inches=&#39;tight&#39;)
plt.show()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Baryons_2022_notes_15_0.png" src="_images/Baryons_2022_notes_15_0.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Set up the probability distributions 
x = np.linspace(140,230, 91)
y_zero = np.zeros(x.shape)
p1 = norm.pdf(x,loc=p_m,scale=sig_p_m)
p2 = prob_p(x,m_pion_pdg,e_m,sig_e_m)
p2 /= p2.sum()
p3 = p1*p2
p3 /= p3.sum()

# Calculate adjusted values
def weighted_avg_and_std(values, weights):
    &quot;&quot;&quot;
    Return the weighted average and standard deviation.

    values, weights -- Numpy ndarrays with the same shape.
    &quot;&quot;&quot;
    average = np.average(values, weights=weights)
    # Fast and numerically precise:
    variance = np.average((values-average)**2, weights=weights)
    return (average, np.sqrt(variance))

p_adjusted, sig_p_adjusted = weighted_avg_and_std(x,p3)

e_adjusted = np.sqrt(m_pion_pdg**2 + p_adjusted**2)
sig_e_adjusted = (p_adjusted * sig_p_adjusted)/(e_adjusted)
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>fig, ax = plt.subplots(1, 1)

#ax.plot(x, p1, color=&#39;g&#39;)
ax.fill_between(x,p1,y_zero,color=&#39;g&#39;,alpha=0.5,label=&#39;Raw Measurement&#39;)
ax.fill_between(x,p2,y_zero,color=&#39;xkcd:windows blue&#39;,alpha=0.5,label=r&#39;Measured energy plus PDG $m_{\pi}$&#39;)
ax.fill_between(x,p3,y_zero,color=&#39;xkcd:amber&#39;,alpha=0.5,label=&#39;Adjusted Measurement&#39;)
ax.axvline(p_adjusted,color=&#39;xkcd:amber&#39;)
ax.annotate(f&#39;Adjusted momentum: {p_adjusted: .2f} MeV/c&#39;, 
            xy=(p_adjusted, 0.07), 
            xytext=(140, 0.08), 
            #fontsize=&#39;large&#39;,
            color=&#39;k&#39;,
            arrowprops=dict(facecolor=&#39;k&#39;,width=2,headwidth=8))
ax.set_xlabel(&#39;Momentum (MeV/c)&#39;)
plt.legend(fontsize=12,loc=&#39;center left&#39;)
plt.savefig(&#39;figures/kinfit_momentum_1d.svg&#39;, bbox_inches=&#39;tight&#39;)
plt.show()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Baryons_2022_notes_17_0.png" src="_images/Baryons_2022_notes_17_0.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x = np.linspace(200,260, 121)
y_zero = np.zeros(x.shape)
p1 = norm.pdf(x,loc=e_m,scale=sig_e_m)
p2 = norm.pdf(x,loc=e_adjusted,scale=sig_e_adjusted)

fig, ax = plt.subplots(1, 1)

ax.fill_between(x,p1,y_zero,color=&#39;xkcd:windows blue&#39;,alpha=0.5, label=&#39;Raw Measurement&#39;)
ax.fill_between(x,p2,y_zero,color=&#39;xkcd:amber&#39;,alpha=0.5, label=&#39;Adjusted Measurement&#39;)
ax.axvline(e_adjusted,color=&#39;xkcd:amber&#39;)
ax.annotate(f&#39;Adjusted energy: {e_adjusted: .2f} MeV&#39;, 
           xy=(e_adjusted, 0.09), 
           xytext=(200, 0.1), 
           #fontsize=&#39;large&#39;,
           color=&#39;k&#39;,
           arrowprops=dict(facecolor=&#39;k&#39;,width=2,headwidth=8))
ax.set_xlabel(&#39;Energy (MeV)&#39;)
plt.legend(fontsize=12,loc=&#39;center left&#39;)
plt.savefig(&#39;figures/kinfit_energy_1d.svg&#39;, bbox_inches=&#39;tight&#39;)

plt.show()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Baryons_2022_notes_18_0.png" src="_images/Baryons_2022_notes_18_0.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Our funky function here
from scipy.special import legendre

def fn(xs):
    P2 = legendre(2)
    P4 = legendre(4)
    return 0.5*P2(xs) + 0.5*P4(xs)


x_fine = np.linspace(-1, 1, 200)
y_fine = fn(x_fine)


xs2 = np.array([-0.9, -0.7, -0.6, -0.35, -0.3, -0.15, -0.1, 0.0, 0.5, 0.8, 1.0])
ys2 = fn(xs2)

err_scale = np.random.uniform(low=0.03, high=0.1, size=ys2.shape)
sys_err = np.random.normal(loc=0, scale=err_scale, size=ys2.shape)

err = 0.5*np.random.gamma(2.0, err_scale, size=ys2.shape)
ys_err = ys2 + sys_err


my_dict = {&#39;x&#39;:xs2, &#39;y_true&#39;:ys2, &#39;err_scale&#39;:err_scale, &#39;sys_err&#39;:sys_err, &#39;err&#39;:err, &#39;ys_err&#39;:ys_err}
my_df = pd.DataFrame(my_dict)
#print(my_df)

plt.title(&#39;Generate Pseudodata&#39;)
plt.errorbar(xs2, ys_err, yerr=err, fmt=&quot;o&quot;, label=&quot;Samples&quot;, markersize=5)
plt.plot(x_fine, y_fine, label=&quot;Function&quot;, color=&quot;k&quot;, lw=1)
plt.ylim(-1.0, 1.0), plt.legend(ncol=2, fontsize=12);
plt.grid(True)
plt.savefig(&#39;figures/gen_pseudodata.svg&#39;, bbox_inches=&#39;tight&#39;)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Baryons_2022_notes_19_0.png" src="_images/Baryons_2022_notes_19_0.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from sklearn.gaussian_process import GaussianProcessRegressor
import sklearn.gaussian_process.kernels as k
from sklearn.gaussian_process.kernels import RBF, ConstantKernel as C


#kernel = k.RBF(length_scale=0.1, length_scale_bounds=(0.01, 2.0))
gp = GaussianProcessRegressor(kernel=RBF(length_scale=0.5, length_scale_bounds=(0.35, 2.0)),alpha=err**2)
gp.fit(np.atleast_2d(xs2).T, ys_err)
y_pred, sigma = gp.predict(np.atleast_2d(x_fine).T, return_std=True)

# 1.96sigma = 95% confidence interval for a normal distribution
upper, lower = y_pred + 1.96 * sigma, y_pred - 1.96 * sigma

plt.title(&#39;Gaussian Process Interpolation&#39;)
plt.errorbar(xs2, ys_err, yerr=err, fmt=&quot;o&quot;, label=&quot;Samples&quot;, markersize=5)
plt.plot(x_fine, y_fine, label=&quot;Function&quot;, color=&quot;k&quot;, lw=1)
plt.plot(x_fine, y_pred, label=&quot;GP&quot;, ls=&quot;-&quot;)
#plt.fill_between(x_fine, upper, lower, alpha=0.2, label=&quot;95% confidence&quot;, color=&quot;#2698eb&quot;)
plt.fill_between(x_fine, upper, lower, alpha=0.2, label=&quot;95\% confidence&quot;, color=&quot;xkcd:amber&quot;)
plt.ylim(-1.0, 1.0), plt.legend(ncol=2, fontsize=12);
plt.grid(True)
plt.savefig(&#39;figures/gp_interpolation.svg&#39;, bbox_inches=&#39;tight&#39;)

#print(f&quot;RBF, length_scale={gp.kernel_.length_scale:0.3f}&quot;)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.10/site-packages/sklearn/gaussian_process/kernels.py:420: ConvergenceWarning: The optimal value found for dimension 0 of parameter length_scale is close to the specified lower bound 0.35. Decreasing the bound and calling fit again may find a better value.
  warnings.warn(
</pre></div>
</div>
<img alt="_images/Baryons_2022_notes_20_1.png" src="_images/Baryons_2022_notes_20_1.png" />
</div>
</div>
</section>
<section id="post-baryons-conference-additions">
<h2>Post Baryons Conference Additions<a class="headerlink" href="#post-baryons-conference-additions" title="Permalink to this headline">#</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Read in table of thresholds...
thresholds_df = pd.read_csv(&#39;Reaction_Thresholds.csv&#39;,header=0,names=[&#39;Reaction&#39;,&#39;E_gamma&#39;,&#39;W&#39;])

#Sort by threshold energy...    
thresholds_df = thresholds_df.sort_values(by=[&#39;W&#39;])

# Add column to indicate target
def reaction_target(str):
    if str.find(&#39;gamma p&#39;) !=-1: 
        target = &#39;proton&#39;
    else:
        target = &#39;neutron&#39;
    return target

thresholds_df[&#39;Target&#39;] = thresholds_df[&#39;Reaction&#39;].apply(reaction_target)

#print(thresholds_df[thresholds_df[&#39;Target&#39;]==&#39;proton&#39;])
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Proton channels
names_p =  thresholds_df[thresholds_df[&#39;Target&#39;]==&#39;proton&#39;][&#39;Reaction&#39;].values
w_thr_p = thresholds_df[thresholds_df[&#39;Target&#39;]==&#39;proton&#39;][&#39;W&#39;].values
# Choose some nice levels
levels_p = np.tile([1, -1, 3, -3, 5, -5, 7, -7, 9, -9],
                 int(np.ceil(len(w_thr_p)/10)))[:len(w_thr_p)]

# Neutron channels
names_n =  thresholds_df[thresholds_df[&#39;Target&#39;]==&#39;neutron&#39;][&#39;Reaction&#39;].values
w_thr_n = thresholds_df[thresholds_df[&#39;Target&#39;]==&#39;neutron&#39;][&#39;W&#39;].values
# Choose some nice levels
levels_n = np.tile([7, -7, 9, -9, 11, -11, 13, -13, 15, -15],
                 int(np.ceil(len(w_thr_n)/10)))[:len(w_thr_n)]

# Create figure and plot a stem plot with the date
fig, ax = plt.subplots(figsize=(8.8, 6), constrained_layout=True)
plt.title(&quot;Meson Photoproduction Thresholds&quot;,fontsize=30, y=1.2)

ax.vlines(w_thr_n, 0, levels_n, color=&quot;tab:blue&quot;)  # The vertical stems.
ax.plot(w_thr_n, np.zeros_like(w_thr_n), &quot;-o&quot;,
        color=&quot;k&quot;, markerfacecolor=&quot;w&quot;)  # Baseline and markers on it.

# annotate lines
for d, l, r in zip(w_thr_p, levels_p, names_p):
    ax.annotate(r, xy=(d, l),
                xytext=(-3, np.sign(l)*3), textcoords=&quot;offset points&quot;,
                horizontalalignment=&quot;center&quot;,
                verticalalignment=&quot;bottom&quot; if l &gt; 0 else &quot;top&quot;)

ax.vlines(w_thr_p, 0, levels_p, color=&quot;tab:red&quot;)  # The vertical stems.
ax.plot(w_thr_p, np.zeros_like(w_thr_p), &quot;-o&quot;,
        color=&quot;k&quot;, markerfacecolor=&quot;w&quot;)  # Baseline and markers on it.

# annotate lines
for d, l, r in zip(w_thr_n, levels_n, names_n):
    ax.annotate(r, xy=(d, l),
                xytext=(-3, np.sign(l)*3), textcoords=&quot;offset points&quot;,
                horizontalalignment=&quot;center&quot;,
                verticalalignment=&quot;bottom&quot; if l &gt; 0 else &quot;top&quot;)


# remove y axis and spines
ax.yaxis.set_visible(False)
ax.spines[[&quot;left&quot;, &quot;top&quot;, &quot;right&quot;]].set_visible(False)
ax.set_xlabel(&#39;$W$ [MeV]&#39;)

mp = 938.272

def eg2w(x):
    return np.sqrt(mp*(mp + 2.0*x))


def w2eg(x):
    return (x*x - mp*mp)/(2.0*mp)

secax = ax.secondary_xaxis(&#39;top&#39;, functions=(w2eg, eg2w))
secax.set_xlabel(&#39;$E_{\gamma}$ [MeV]&#39;)

ax.margins(y=0.1)
plt.savefig(&#39;figures/thresholds.svg&#39;, bbox_inches=&#39;tight&#39;)
plt.show()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Baryons_2022_notes_23_0.png" src="_images/Baryons_2022_notes_23_0.png" />
</div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Last updated: 2022-12-29T17:23:26.982380+00:00

Python implementation: CPython
Python version       : 3.10.8
IPython version      : 8.7.0

Compiler    : GCC 10.4.0
OS          : Linux
Release     : 4.19.128-microsoft-standard
Machine     : x86_64
Processor   : x86_64
CPU cores   : 8
Architecture: 64bit
</pre></div>
</div>
</div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pandas    : 1.5.2
matplotlib: 3.6.2
seaborn   : 0.12.1
numpy     : 1.23.5
sklearn   : 1.2.0
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="intro.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Welcome to your Jupyter Book</p>
        </div>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Dave Ireland<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>